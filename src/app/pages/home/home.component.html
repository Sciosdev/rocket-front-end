<div class="background img-fluid">
  <div class="step-container">
    <div class="row mt-4">
      <div class="col-lg-3 col-md-12 col-sm-12">
        <form>
          <mat-form-field style="width: 100%;">
            <mat-label>Localiza tu envío</mat-label>
            <input matInput name="label-archivo" type="search" placeholder="Código de rastreo"
              [(ngModel)]="registerKey" />
          </mat-form-field>
        </form>
      </div>

      <div class="col-md-12 col-lg-9 col-sm-12">
        <button mat-raised-button color="accent" matRipple (click)="myMethodChangingQueryParams()">
          <nb-icon icon="search-outline"></nb-icon>
          Buscar
        </button>
      </div>

      <div class="d-flex justify-content-center w-100">
        <nb-card *ngIf="events.length > 0" class="w-100">
          <nb-card-body>
            <div class="m-3">
              <div class="row">
                <div class="col-md-12">
                  <div [ngClass]="colorEstatus">
                    <div class="row">
                      <div class="col-md-1">
                        <div class="d-flex justify-content-center">
                          <nb-icon [icon]="mainIcon" style="font-size: 4rem" pack="font-awesome"></nb-icon>
                        </div>
                      </div>
                      <div class="col-md-11">
                        <h4>{{tipoEstatus}}</h4>
                        {{estatusActual.desc}}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row timeline">
                <div class="col-md-12">
                  <div class="d-flex justify-content-center">
                    <p-timeline [value]="mainEvents" layout="horizontal" [style.width]="'100%'">
                      <ng-template pTemplate="marker" let-event>
                        <i [ngClass]="event.icon" [style.color]="event.color" style="font-size: 3rem"></i>
                      </ng-template>
                      <ng-template pTemplate="content" let-event>
                        {{event.type}}
                      </ng-template>
                    </p-timeline>
                  </div>

                </div>
              </div>
              <hr>
              <div class="row p-3">
                <div class="col-md-6  p-3">
                  <h6>Número de guia: {{registerKey}}</h6> 
                  <mat-divider></mat-divider>

                  <div class="d-flex">
                    <div class="p-2">Nombre: </div>
                    <div class="p-2">{{destino.name}}</div>
                  </div>
                  <div class="d-flex">
                    <div class="p-2">Nombre: </div>
                    <div class="p-2">{{destino.name}}</div>
                  </div>
                  <div class="d-flex">
                    <div class="p-2">Nombre: </div>
                    <div class="p-2">{{destino.name}}</div>
                  </div>
                  <div class="d-flex">
                    <div class="p-2">Nombre: </div>
                    <div class="p-2">{{destino.name}}</div>
                  </div>

                </div>
                <div class="col-md-6 historial p-3">
                  <h6>Historial</h6>
                  <mat-divider></mat-divider>
                  <p-scrollPanel [style]="{width: '100%', height: '250px'}" styleClass="custom bg-light">
                    <span *ngFor="let item of events">
                      <div class="p-2">
                        <b>{{toDate(item.fecha.year, item.fecha.month,item.fecha.day) | date:'fullDate'}}</b>
                      </div>
                      <mat-list class="border-bottom ">
                        <mat-list-item *ngFor="let log of item.log" >
                          <div class="border-right m-3" style="width:200px">{{log.estatus}}</div>
                          <div ><small>{{log.fecha}}</small></div>
                        </mat-list-item>
                      </mat-list>
                     
                    </span>

                  </p-scrollPanel>

                </div>


              </div>

            </div>
          </nb-card-body>
        </nb-card>

      </div>
    </div>
  </div>
</div>

<ngx-loading-x [show]="loading">
</ngx-loading-x>